name = "moperator"
main = "src/index.ts"
compatibility_date = "2024-12-01"
compatibility_flags = ["nodejs_compat"]

# KV namespace for agent registry
[[kv_namespaces]]
binding = "AGENT_REGISTRY"
id = "72d1d8cbfa2d49dba119ab8192d0abd6"

# KV namespace for email history
[[kv_namespaces]]
binding = "EMAIL_HISTORY"
id = "e16f32908a8d4b5e879da6a91a0eaafa"

# KV namespace for retry queue
[[kv_namespaces]]
binding = "RETRY_QUEUE"
id = "b6550b26572e462bad5014410f18684f"

# KV namespace for rate limiting
[[kv_namespaces]]
binding = "RATE_LIMIT"
id = "73009adf28f0493885e23201fb0942f2"

# KV namespace for multi-tenant user data
[[kv_namespaces]]
binding = "TENANTS"
id = "c17b49885c324cefaf005ddfdf1094b6"

# Cron trigger for retry processing and health checks (every 5 minutes)
[triggers]
crons = ["*/5 * * * *"]

# Secrets (set via wrangler secret put):
# - ANTHROPIC_API_KEY: Claude API key
# - WEBHOOK_SIGNING_KEY: HMAC signing key for webhook payloads
# - API_KEY: (Optional) Legacy API key for system-wide agent management
# - ADMIN_SECRET: Admin secret for tenant management endpoints

# Email routing (configure in Cloudflare dashboard)
# Routes: *@moperator.work -> this worker
